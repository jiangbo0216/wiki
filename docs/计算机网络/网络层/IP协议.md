
## 网络层数据交换
![20200329220533](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200329220533.png)

主要任务是把**分组**从源端传送到目的端, 为分组交换网上的不同主机提供通信服务

网络层传输单位是**数据报**

分组是数据报的分割

功能:
* 路由选择与分组转发
* 异构网的互联(路由器)
* 拥塞控制
  * 如果所有的节点都来不及接受分组, 而要丢弃大量的分组的话, 网络就要处于拥塞状态, 因此要采取一定的措施缓解一定的措施, 缓解这种拥塞
  * 解决办法
    * 开环控制  静态
    * 闭环控制  动态

## 数据交换方式

![20200329224318](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200329224318.png)

交换设备: 二层的交换机, 网桥, 或者是三层的路由器

* 集线器：工作在物理层，用于构成冲突域（广播域）。
* 网桥/交换机：工作在数据链路层，用于连接不同的网络。网桥/交换机会在自身存储其硬件端口与MAC地址的映射关系。一般使用网桥/交换机隔离LAN。简单来说，网桥可以看做一个端口数少的交换机。
* 路由器：工作在网络层。用于连接不同网络，进行分组转发。区别在于，网桥/交换机根据MAC转发，路由器根据ip进行转发。


为了解决单个交换设备的数据吞吐量或者说流量, 以及传输距离过长, 信号衰减, 故而采用了交换网络的方式, 多交换设备互联
![20200329221617](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200329221617.png)

* 电路交换
* 报文交换
* 分组交换
  * 数据报方式
  * 虚电路方式

### 电路交换
电话网络, 可能包含多路复用

特点:
独占资源

优点:
1. 通信时延小
2. 有序传输
3. 没有冲突
4. 实时性强

缺点:
1. 建立连接时间长
2. 线路独占,使用效率低
3. 灵活性差
4. 无差错控制能力

### 报文交换
报文: 源应用发送的信息整体

优点:
1. 无需建立连接
2. 存储转发,动态分配线路
3. 线路可靠性较高
4. 线路利用率较高
5. 多目标服务

缺点:
1. 存储转发时延
2. 报文大小不定, 需要网络节点又较大的缓存空间

![20200329225416](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200329225416.png)

### 分组转发

![20200329230401](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200329230401.png)
优点
1. 无需建立连接
2. 存储转发,动态分配线路
3. 线路可靠性较高
4. 线路利用率较高
5. 相对于报文交换,存储管理更容易

缺点:
1. 存储转发时延
2. 需要传输额外的信息量
3. 乱序到目的主机时,要对分组排序重组

### 报文交换&分组交换
![20200329231226](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200329231226.png)

### 三种交换方式比较总结
![20200331214416](https://raw.githubusercontent.com/jiangbo0216/wiki/pic-bed/20200331214416.png)

### 几种传输单元名词辨析
应用层  报文
传输层  报文段
网络层  IP数据报，分组
数据链路层  帧
物理层  比特流

### 数据报&虚电路
* 数据报方式为网络层提供无连接服务
* 虚电路提供连接服务

* 无连接服务: 不事先为分组的传输确定传输路径, 每个分组独立确定传输路径, 不同分组传输路径可能不同
* 连接服务: 首先为分组的传输确定传输路径(建立连接), 然后沿该路径(连接)传输系列分组, 系列分组传输路径相同, 传输结束过后拆除连接



## IP协议

说明网络中的计算机使用IP标记主机的位置, 以及如何通过路由找到这个IP地址对应的主机

## 网际控制报文协议(Internet Control Message Protocal)
why: 有效地转发IP数据包和提高交付成功的机会
what: ICMP允许主机或路由器报告差错情况和提供异常情况的报告. 
how: 是因特网的的标准协议,ICMP报文时装在IP数据报中,作为其中的数据组成部分

### 分类
* ICMP差错报告报文
* ICMP询问报文

### ICMP差错报告报文
分类:
1. 终点不可达
2. 源点抑制
3. 时间超过
4. 参数问题
5. 改变路由

### 应用实例
1. ping
2. traceroute(UNIX) 或者 tracert(windows)

## 路由选择协议
what: 讨论路由表中的路由如何得出, 路由表生成算法
路由表生成算法具备的性质:
1. 正确完整
2. 计算简单
3. 自适应
4. 稳定性
5. 公平性
6. 最佳


### 分类
1. 内部网关协议(内部路由器协议)
2. 外部网关协议(外部路由器协议)



   




