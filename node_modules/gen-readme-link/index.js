const fs = require('fs/promises')

const path = require('path')

const parent = path.resolve(process.cwd(), 'docs')
async function build () {
  console.log(process.cwd())
  try {
    const files = await fs.readdir(parent);
    let dirNames = []
    for (const file of files) {
      const dirName = path.resolve(parent, file)
      const stat = await fs.stat(dirName)
      if (stat.isDirectory()) {
        dirNames.push([file, dirName])
      }

      
    }

    let content = ''
    const readmeFile = path.resolve(process.cwd(), 'README.md')
    content += '## 目录\n'
    for (const dirName of dirNames) {
      const releativePath = path.relative(process.cwd(), dirName[1])
      content += (`[${dirName[0]}](${releativePath})  \n`).replace(/\\/g, '/')
    }
    try {

      await fs.writeFile(readmeFile, content)
    } catch (error) {
      fs.writeFile
    }
    


  } catch (err) {
    console.error(err);
  }
}


exports.build = build

build()